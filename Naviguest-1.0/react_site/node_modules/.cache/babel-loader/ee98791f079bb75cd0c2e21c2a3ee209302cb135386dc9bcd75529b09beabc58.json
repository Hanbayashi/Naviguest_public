{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\81807\\\\Naviguest_public\\\\Naviguest-1.0\\\\react_site\\\\src\\\\Map.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport backbutton from './assets/BackButton.png';\nimport F1button from './assets/1F.png';\nimport F2button from './assets/2F.png';\nimport F3button from './assets/3F.png';\nimport F4button from './assets/4F.png';\nimport F5button from './assets/5F.png';\nimport F6button from './assets/6F.png';\nimport point1 from './assets/point1.png';\nimport point2 from './assets/point2.png';\nimport point3 from './assets/point3.png';\nimport point4 from './assets/point4.png';\nimport point5 from './assets/point5.png';\nimport point6 from './assets/point6.png';\nimport point7 from './assets/point7.png';\nimport point8 from './assets/point8.png';\nimport point9 from './assets/point9.png';\nimport point10 from './assets/point1.png';\nimport point11 from './assets/point1.png';\nimport point12 from './assets/point1.png';\nimport point13 from './assets/point1.png';\nimport point14 from './assets/point1.png';\nimport point15 from './assets/point1.png';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst floorImages = {\n  '1F': F1button,\n  '2F': F2button,\n  '3F': F3button,\n  '4F': F4button,\n  '5F': F5button,\n  '6F': F6button\n};\nconst MapPage = () => {\n  _s();\n  // 入力欄に表示される値とバリデーションエラーメッセージ\n  const [arrivedNumber, setArrivedNumber] = useState('');\n  const [inputError, setInputError] = useState('');\n\n  // Pythonから取得する経路探索結果のState\n  const [nextPoint, setNextPoint] = useState(null);\n  const [currentFloor, setCurrentFloor] = useState(null);\n  const [currentBuilding, setCurrentBuilding] = useState(null);\n  const [goalNode, setGoalNode] = useState(null); // 設定された目的地ノード\n  const [guidanceMessage, setGuidanceMessage] = useState('経路案内を待機中...'); // Pythonからの案内メッセージ\n\n  // API通信の状態管理\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // ★★★ 確定された現在のマップ上のノード（Pythonに送信される値） ★★★\n  // 初期位置を1とするが、これはMapPageがロードされた時に一度だけPythonに送られる初期値\n  const [confirmedMapNode, setConfirmedMapNode] = useState(1);\n  const [currentFloorDisplayImage, setCurrentFloorDisplayImage] = useState(floorImages['default']);\n\n  // 入力欄の変更を処理するハンドラ\n  const handleInputChange = e => {\n    const value = e.target.value;\n    setInputError(''); // 入力開始時にエラーメッセージをクリア\n\n    // 1. 数字のみを許可\n    if (!/^\\d*$/.test(value)) {\n      setArrivedNumber(value);\n      setInputError('数字のみ入力してください。');\n      return;\n    }\n\n    // 2. 最大2桁に制限\n    if (value.length > 2) {\n      setArrivedNumber(value.slice(0, 2)); // 2桁を超える入力を切り捨てる\n      setInputError('最大2桁の数字を入力してください。');\n      return;\n    }\n\n    // 3. 値が空の場合の処理\n    if (value === '') {\n      setArrivedNumber('');\n      setInputError('');\n      return;\n    }\n\n    // 入力値が有効な形式であれば、arrivedNumberを更新\n    setArrivedNumber(value);\n    // ここではまだ confirmedMapNode を更新しない。確定ボタンで更新する。\n  };\n\n  // 「確定」ボタンクリック時のハンドラ\n  const handleConfirmCurrentNode = () => {\n    const numValue = parseInt(arrivedNumber, 10);\n\n    // バリデーションチェック\n    if (arrivedNumber === '') {\n      setInputError('現在の場所の番号を入力してください。');\n      return;\n    }\n    if (isNaN(numValue) || numValue < 1 || numValue > 32) {\n      setInputError('1から32までの有効な数字を入力してください。');\n      return;\n    }\n\n    // 全てのバリデーションを通過したら、確定されたノードを更新し、Pythonへのリクエストをトリガー\n    setConfirmedMapNode(numValue);\n    setInputError(''); // エラーメッセージをクリア\n    // setArrivedNumber(''); // 確定後に入力欄をクリアしたい場合はコメントを外す\n  };\n\n  // Pythonバックエンドから経路データをフェッチするuseEffect\n  // confirmedMapNode が変更されるたびに実行される\n  useEffect(() => {\n    const fetchPathData = async () => {\n      try {\n        setLoading(true);\n        setError(null); // エラー状態をリセット\n\n        // Pythonの /api/get_next_point エンドポイントに現在のノードをPOSTで送信\n        const response = await fetch('http://127.0.0.1:5000/api/get_next_point', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            current_node: confirmedMapNode\n          }) // 確定されたノードを送信\n        });\n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n\n        // Pythonからの経路探索結果をStateにセット\n        setNextPoint(data.next_point);\n        setCurrentFloor(data.current_floor);\n        setCurrentBuilding(data.current_building);\n        setGoalNode(data.goal_node);\n        setGuidanceMessage(data.message);\n\n        // ★★★ ここで current_floor に基づいて表示画像を更新 ★★★\n        if (data.current_floor && floorImages[data.current_floor]) {\n          setCurrentFloorDisplayImage(floorImages[data.current_floor]);\n        }\n      } catch (err) {\n        console.error(\"MapPageでのPython API呼び出しエラー:\", err);\n        setError(\"経路データの取得に失敗しました。\");\n        setGuidanceMessage(\"経路データの取得に失敗しました。\"); // UIにもエラーメッセージを表示\n      } finally {\n        setLoading(false); // ローディング状態を解除\n      }\n    };\n    fetchPathData(); // コンポーネントのマウント時と confirmedMapNode 変更時に実行\n  }, [confirmedMapNode]); // confirmedMapNode が変わるたびに useEffect を再実行\n\n  // 「次のポイントへ進む」ボタンのハンドラ (デモ用)\n  const handleMoveToNextPoint = () => {\n    if (nextPoint !== null) {\n      // 次のポイントへ進む際も、confirmedMapNode を更新して経路探索を再トリガー\n      setConfirmedMapNode(nextPoint);\n      setArrivedNumber(String(nextPoint)); // 入力欄にも次のポイントを反映\n    } else {\n      alert(\"次の移動ポイントはありません。目的地に到着したか、経路が見つかりませんでした。\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      style: {\n        backgroundColor: '#0066cc',\n        color: 'white',\n        padding: '1rem 2rem',\n        textAlign: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        style: {\n          fontSize: '48px'\n        },\n        children: \"\\u30CA\\u30D3\\u30B2\\u30B9\\u30C8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '2rem',\n        textAlign: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u73FE\\u5728\\u5730\\u304B\\u3089\\u76EE\\u7684\\u5730\\u307E\\u3067\\u306E\\u6848\\u5185\\u753B\\u9762\\u3067\\u3059\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this), loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u7D4C\\u8DEF\\u30C7\\u30FC\\u30BF\\u3092\\u8AAD\\u307F\\u8FBC\\u307F\\u4E2D...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 11\n      }, this) : error ? /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'red'\n        },\n        children: [\"\\u30A8\\u30E9\\u30FC: \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontSize: '1.5rem',\n          fontWeight: 'bold',\n          color: '#000',\n          marginBottom: '1rem'\n        },\n        children: [\" \", \"\\u6848\\u5185: \", /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: '#d9534f'\n          },\n          children: guidanceMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '80%',\n          // height: '600px', // 高さを固定する代わりに、画像の縦横比に合わせるか、min-heightを使用\n          minHeight: '400px',\n          // 最低限の高さを確保\n          margin: '2rem auto',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          overflow: 'hidden',\n          // 画像がはみ出さないように\n          position: 'relative'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: currentFloorDisplayImage // ★★★ Pythonから取得した階に応じた画像を表示 ★★★\n          ,\n          alt: \"\\u73FE\\u5728\\u306E\\u968E\\u306E\\u30DE\\u30C3\\u30D7\",\n          style: {\n            maxWidth: '100%',\n            // 親divの幅に収まるように\n            height: 'auto',\n            // 縦横比を維持\n            display: 'block',\n            // img要素の不要な余白を削除\n            border: '2px solid black',\n            zIndex: 1\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: point1,\n          alt: \"\\u73FE\\u5728\\u5730\\u30DD\\u30A4\\u30F3\\u30C8\",\n          style: {\n            position: 'absolute',\n            top: '50.5%',\n            left: '43%',\n            width: '50px',\n            height: 'auto',\n            zIndex: 2\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: point2,\n          alt: \"\\u73FE\\u5728\\u5730\\u30DD\\u30A4\\u30F3\\u30C8\",\n          style: {\n            position: 'absolute',\n            top: '65%',\n            left: '30%',\n            width: '75px',\n            height: 'auto',\n            zIndex: 2\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: point3,\n          alt: \"\\u73FE\\u5728\\u5730\\u30DD\\u30A4\\u30F3\\u30C8\",\n          style: {\n            position: 'absolute',\n            top: '46%',\n            left: '30%',\n            width: '75px',\n            height: 'auto',\n            zIndex: 2\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: point4,\n          alt: \"\\u73FE\\u5728\\u5730\\u30DD\\u30A4\\u30F3\\u30C8\",\n          style: {\n            position: 'absolute',\n            top: '21%',\n            left: '44%',\n            width: '75px',\n            height: 'auto',\n            zIndex: 2\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: point5,\n          alt: \"\\u73FE\\u5728\\u5730\\u30DD\\u30A4\\u30F3\\u30C8\",\n          style: {\n            position: 'absolute',\n            top: '46%',\n            left: '55%',\n            width: '75px',\n            height: 'auto',\n            zIndex: 2\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        marginBottom: '2rem'\n      },\n      children: loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u7D4C\\u8DEF\\u30C7\\u30FC\\u30BF\\u3092\\u8AAD\\u307F\\u8FBC\\u307F\\u4E2D...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 11\n      }, this) : error ? /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'red'\n        },\n        children: [\"\\u30A8\\u30E9\\u30FC: \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '1.2rem',\n            fontWeight: 'bold',\n            color: '#333'\n          },\n          children: [\"\\u73FE\\u5728\\u306E\\u30CE\\u30FC\\u30C9: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#0066cc'\n            },\n            children: confirmedMapNode\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '1.2rem',\n            fontWeight: 'bold',\n            color: '#333'\n          },\n          children: [\"\\u73FE\\u5728\\u306E\\u968E: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#0066cc'\n            },\n            children: currentFloor || 'N/A'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '1.2rem',\n            fontWeight: 'bold',\n            color: '#333'\n          },\n          children: [\"\\u73FE\\u5728\\u306E\\u9928: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#0066cc'\n            },\n            children: currentBuilding || 'N/A'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '1.2rem',\n            fontWeight: 'bold',\n            color: '#333'\n          },\n          children: [\"\\u76EE\\u7684\\u5730\\u30CE\\u30FC\\u30C9: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#28a745'\n            },\n            children: goalNode || '未設定'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '1.5rem',\n            fontWeight: 'bold',\n            color: '#000'\n          },\n          children: [\"\\u6848\\u5185: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#d9534f'\n            },\n            children: guidanceMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '1.2rem',\n            fontWeight: 'bold',\n            color: '#333'\n          },\n          children: [\"\\u6B21\\u306E\\u30DD\\u30A4\\u30F3\\u30C8: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#5cb85c'\n            },\n            children: nextPoint !== null ? nextPoint : '到着'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 13\n        }, this), nextPoint !== null &&\n        /*#__PURE__*/\n        // 次のポイントが存在する場合のみボタンを表示\n        _jsxDEV(\"button\", {\n          onClick: handleMoveToNextPoint,\n          style: {\n            padding: '10px 20px',\n            fontSize: '1.2rem',\n            marginTop: '15px',\n            cursor: 'pointer',\n            backgroundColor: '#007bff',\n            color: 'white',\n            border: 'none',\n            borderRadius: '5px'\n          },\n          children: \"\\u6B21\\u306E\\u30DD\\u30A4\\u30F3\\u30C8\\u3078\\u9032\\u3080 (\\u30C7\\u30E2\\u7528)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '2rem',\n        textAlign: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u73FE\\u5728\\u306E\\u5834\\u6240\\u306E\\u756A\\u53F7\\u3092\\u5165\\u529B\\u3057\\u3001\\u78BA\\u5B9A\\u30DC\\u30BF\\u30F3\\u3092\\u62BC\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\\u3002\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        marginBottom: '1rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        pattern: \"\\\\d{1,2}\",\n        inputMode: \"numeric\",\n        value: arrivedNumber,\n        onChange: handleInputChange // 入力値の変更をハンドル\n        ,\n        placeholder: \"\\u4F8B: 1 (1\\u301C32)\",\n        maxLength: \"2\",\n        style: {\n          padding: '0.8rem',\n          fontSize: '1.2rem',\n          width: '250px',\n          textAlign: 'center',\n          borderRadius: '5px',\n          border: inputError ? '2px solid red' : '1px solid #ccc',\n          marginBottom: '10px' // ボタンとの間の余白\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 9\n      }, this), inputError && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'red',\n          fontSize: '0.9rem',\n          marginTop: '0.5rem'\n        },\n        children: inputError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleConfirmCurrentNode // クリック時に現在地を確定\n        ,\n        style: {\n          padding: '10px 20px',\n          fontSize: '1.2rem',\n          cursor: 'pointer',\n          backgroundColor: '#28a745',\n          // 緑色のボタン\n          color: 'white',\n          border: 'none',\n          borderRadius: '5px',\n          display: 'block',\n          // ブロック要素にして中央揃えを容易に\n          margin: '0.5rem auto 0 auto' // 上に余白、左右中央揃え\n        },\n        children: \"\\u78BA\\u5B9A\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        marginBottom: '2rem'\n      },\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/choose\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: backbutton,\n          alt: \"\\u623B\\u308B\",\n          style: {\n            width: '200px',\n            height: 'auto'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      style: {\n        backgroundColor: '#ddd',\n        textAlign: 'center',\n        padding: '1rem'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\xA9 2025 \\u30CA\\u30D3\\u30B2\\u30B9\\u30C8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n// コンポーネント名を MapPage に変更してエクスポート\n_s(MapPage, \"RgGSwLCskT06PDDWJHoHjjtaQ8A=\");\n_c = MapPage;\nexport default MapPage;\nvar _c;\n$RefreshReg$(_c, \"MapPage\");","map":{"version":3,"names":["React","useState","useEffect","Link","backbutton","F1button","F2button","F3button","F4button","F5button","F6button","point1","point2","point3","point4","point5","point6","point7","point8","point9","point10","point11","point12","point13","point14","point15","jsxDEV","_jsxDEV","Fragment","_Fragment","floorImages","MapPage","_s","arrivedNumber","setArrivedNumber","inputError","setInputError","nextPoint","setNextPoint","currentFloor","setCurrentFloor","currentBuilding","setCurrentBuilding","goalNode","setGoalNode","guidanceMessage","setGuidanceMessage","loading","setLoading","error","setError","confirmedMapNode","setConfirmedMapNode","currentFloorDisplayImage","setCurrentFloorDisplayImage","handleInputChange","e","value","target","test","length","slice","handleConfirmCurrentNode","numValue","parseInt","isNaN","fetchPathData","response","fetch","method","headers","body","JSON","stringify","current_node","ok","Error","status","data","json","next_point","current_floor","current_building","goal_node","message","err","console","handleMoveToNextPoint","String","alert","children","style","backgroundColor","color","padding","textAlign","fontSize","fileName","_jsxFileName","lineNumber","columnNumber","fontWeight","marginBottom","width","minHeight","margin","display","justifyContent","alignItems","overflow","position","src","alt","maxWidth","height","border","zIndex","top","left","onClick","marginTop","cursor","borderRadius","type","pattern","inputMode","onChange","placeholder","maxLength","to","_c","$RefreshReg$"],"sources":["C:/Users/81807/Naviguest_public/Naviguest-1.0/react_site/src/Map.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport backbutton from './assets/BackButton.png';\r\nimport F1button from './assets/1F.png';\r\nimport F2button from './assets/2F.png';\r\nimport F3button from './assets/3F.png';\r\nimport F4button from './assets/4F.png';\r\nimport F5button from './assets/5F.png';\r\nimport F6button from './assets/6F.png';\r\n\r\nimport point1 from './assets/point1.png';\r\nimport point2 from './assets/point2.png';\r\nimport point3 from './assets/point3.png';\r\nimport point4 from './assets/point4.png';\r\nimport point5 from './assets/point5.png';\r\nimport point6 from './assets/point6.png';\r\nimport point7 from './assets/point7.png';\r\nimport point8 from './assets/point8.png';\r\nimport point9 from './assets/point9.png';\r\nimport point10 from './assets/point1.png';\r\nimport point11 from './assets/point1.png';\r\nimport point12 from './assets/point1.png';\r\nimport point13 from './assets/point1.png';\r\nimport point14 from './assets/point1.png';\r\nimport point15 from './assets/point1.png';\r\n\r\nconst floorImages = {\r\n  '1F': F1button,\r\n  '2F': F2button,\r\n  '3F': F3button,\r\n  '4F': F4button,\r\n  '5F': F5button,\r\n  '6F': F6button,\r\n};\r\n\r\nconst MapPage = () => {\r\n  // 入力欄に表示される値とバリデーションエラーメッセージ\r\n  const [arrivedNumber, setArrivedNumber] = useState('');\r\n  const [inputError, setInputError] = useState('');\r\n\r\n  // Pythonから取得する経路探索結果のState\r\n  const [nextPoint, setNextPoint] = useState(null);\r\n  const [currentFloor, setCurrentFloor] = useState(null);\r\n  const [currentBuilding, setCurrentBuilding] = useState(null);\r\n  const [goalNode, setGoalNode] = useState(null); // 設定された目的地ノード\r\n  const [guidanceMessage, setGuidanceMessage] = useState('経路案内を待機中...'); // Pythonからの案内メッセージ\r\n\r\n  // API通信の状態管理\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // ★★★ 確定された現在のマップ上のノード（Pythonに送信される値） ★★★\r\n  // 初期位置を1とするが、これはMapPageがロードされた時に一度だけPythonに送られる初期値\r\n  const [confirmedMapNode, setConfirmedMapNode] = useState(1);\r\n\r\n  const [currentFloorDisplayImage, setCurrentFloorDisplayImage] = useState(floorImages['default']);\r\n\r\n  // 入力欄の変更を処理するハンドラ\r\n  const handleInputChange = (e) => {\r\n    const value = e.target.value;\r\n    setInputError(''); // 入力開始時にエラーメッセージをクリア\r\n\r\n    // 1. 数字のみを許可\r\n    if (!/^\\d*$/.test(value)) {\r\n      setArrivedNumber(value);\r\n      setInputError('数字のみ入力してください。');\r\n      return;\r\n    }\r\n\r\n    // 2. 最大2桁に制限\r\n    if (value.length > 2) {\r\n      setArrivedNumber(value.slice(0, 2)); // 2桁を超える入力を切り捨てる\r\n      setInputError('最大2桁の数字を入力してください。');\r\n      return;\r\n    }\r\n\r\n    // 3. 値が空の場合の処理\r\n    if (value === '') {\r\n      setArrivedNumber('');\r\n      setInputError('');\r\n      return;\r\n    }\r\n\r\n    // 入力値が有効な形式であれば、arrivedNumberを更新\r\n    setArrivedNumber(value);\r\n    // ここではまだ confirmedMapNode を更新しない。確定ボタンで更新する。\r\n  };\r\n\r\n  // 「確定」ボタンクリック時のハンドラ\r\n  const handleConfirmCurrentNode = () => {\r\n    const numValue = parseInt(arrivedNumber, 10);\r\n\r\n    // バリデーションチェック\r\n    if (arrivedNumber === '') {\r\n      setInputError('現在の場所の番号を入力してください。');\r\n      return;\r\n    }\r\n    if (isNaN(numValue) || numValue < 1 || numValue > 32) {\r\n      setInputError('1から32までの有効な数字を入力してください。');\r\n      return;\r\n    }\r\n\r\n    // 全てのバリデーションを通過したら、確定されたノードを更新し、Pythonへのリクエストをトリガー\r\n    setConfirmedMapNode(numValue);\r\n    setInputError(''); // エラーメッセージをクリア\r\n    // setArrivedNumber(''); // 確定後に入力欄をクリアしたい場合はコメントを外す\r\n  };\r\n\r\n  // Pythonバックエンドから経路データをフェッチするuseEffect\r\n  // confirmedMapNode が変更されるたびに実行される\r\n  useEffect(() => {\r\n    const fetchPathData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(null); // エラー状態をリセット\r\n\r\n        // Pythonの /api/get_next_point エンドポイントに現在のノードをPOSTで送信\r\n        const response = await fetch('http://127.0.0.1:5000/api/get_next_point', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({ current_node: confirmedMapNode }), // 確定されたノードを送信\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP error! status: ${response.status}`);\r\n        }\r\n        const data = await response.json();\r\n\r\n        // Pythonからの経路探索結果をStateにセット\r\n        setNextPoint(data.next_point);\r\n        setCurrentFloor(data.current_floor);\r\n        setCurrentBuilding(data.current_building);\r\n        setGoalNode(data.goal_node);\r\n        setGuidanceMessage(data.message);\r\n\r\n        // ★★★ ここで current_floor に基づいて表示画像を更新 ★★★\r\n        if (data.current_floor && floorImages[data.current_floor]) {\r\n          setCurrentFloorDisplayImage(floorImages[data.current_floor]);\r\n        }\r\n\r\n      } catch (err) {\r\n        console.error(\"MapPageでのPython API呼び出しエラー:\", err);\r\n        setError(\"経路データの取得に失敗しました。\");\r\n        setGuidanceMessage(\"経路データの取得に失敗しました。\"); // UIにもエラーメッセージを表示\r\n      } finally {\r\n        setLoading(false); // ローディング状態を解除\r\n      }\r\n    };\r\n\r\n    fetchPathData(); // コンポーネントのマウント時と confirmedMapNode 変更時に実行\r\n  }, [confirmedMapNode]); // confirmedMapNode が変わるたびに useEffect を再実行\r\n\r\n  // 「次のポイントへ進む」ボタンのハンドラ (デモ用)\r\n  const handleMoveToNextPoint = () => {\r\n    if (nextPoint !== null) {\r\n      // 次のポイントへ進む際も、confirmedMapNode を更新して経路探索を再トリガー\r\n      setConfirmedMapNode(nextPoint);\r\n      setArrivedNumber(String(nextPoint)); // 入力欄にも次のポイントを反映\r\n    } else {\r\n      alert(\"次の移動ポイントはありません。目的地に到着したか、経路が見つかりませんでした。\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* ヘッダーセクション */}\r\n      <header\r\n        style={{\r\n          backgroundColor: '#0066cc',\r\n          color: 'white',\r\n          padding: '1rem 2rem',\r\n          textAlign: 'center',\r\n        }}\r\n      >\r\n        <h1 style={{ fontSize: '48px' }}>ナビゲスト</h1>\r\n      </header>\r\n\r\n      {/* マップ表示エリアセクション */}\r\n      <div style={{ padding: '2rem', textAlign: 'center' }}>\r\n        <h2>現在地から目的地までの案内画面です</h2>\r\n\r\n        {loading ? (\r\n          <p>経路データを読み込み中...</p>\r\n        ) : error ? (\r\n          <p style={{ color: 'red' }}>エラー: {error}</p>\r\n        ) : (\r\n          <p style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#000', marginBottom: '1rem' }}> {/* 下マージンを追加してマップとの隙間を作る */}\r\n            案内: <span style={{ color: '#d9534f' }}>{guidanceMessage}</span>\r\n          </p>\r\n        )}\r\n\r\n        <div\r\n          style={{\r\n            width: '80%',\r\n            // height: '600px', // 高さを固定する代わりに、画像の縦横比に合わせるか、min-heightを使用\r\n            minHeight: '400px', // 最低限の高さを確保\r\n            margin: '2rem auto',\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n            overflow: 'hidden', // 画像がはみ出さないように\r\n            position: 'relative',\r\n          }}\r\n        >\r\n          <img\r\n            src={currentFloorDisplayImage} // ★★★ Pythonから取得した階に応じた画像を表示 ★★★\r\n            alt=\"現在の階のマップ\"\r\n            style={{\r\n              maxWidth: '100%', // 親divの幅に収まるように\r\n              height: 'auto',    // 縦横比を維持\r\n              display: 'block',  // img要素の不要な余白を削除\r\n              border: '2px solid black',\r\n              zIndex: 1,\r\n            }}\r\n          />\r\n          \r\n          {/* 1階のノードポイント */}\r\n          <img\r\n            src={point1} \r\n            alt=\"現在地ポイント\" \r\n            style={{\r\n              position: 'absolute',\r\n              top: '50.5%',\r\n              left: '43%',\r\n              width: '50px',\r\n              height: 'auto',\r\n              zIndex: 2,\r\n            }}\r\n          />\r\n\r\n          <img\r\n            src={point2} \r\n            alt=\"現在地ポイント\" \r\n            style={{\r\n              position: 'absolute',\r\n              top: '65%',\r\n              left: '30%',\r\n              width: '75px',\r\n              height: 'auto',\r\n              zIndex: 2,\r\n            }}\r\n          />\r\n\r\n          <img\r\n            src={point3} \r\n            alt=\"現在地ポイント\" \r\n            style={{\r\n              position: 'absolute',\r\n              top: '46%',\r\n              left: '30%',\r\n              width: '75px',\r\n              height: 'auto',\r\n              zIndex: 2,\r\n            }}\r\n          />\r\n\r\n          <img\r\n            src={point4} \r\n            alt=\"現在地ポイント\" \r\n            style={{\r\n              position: 'absolute',\r\n              top: '21%',\r\n              left: '44%',\r\n              width: '75px',\r\n              height: 'auto',\r\n              zIndex: 2,\r\n            }}\r\n          />\r\n\r\n          <img\r\n            src={point5} \r\n            alt=\"現在地ポイント\" \r\n            style={{\r\n              position: 'absolute',\r\n              top: '46%',\r\n              left: '55%',\r\n              width: '75px',\r\n              height: 'auto',\r\n              zIndex: 2,\r\n            }}\r\n          />\r\n\r\n        </div>\r\n      </div>\r\n\r\n\r\n      {/* Pythonからの経路案内データ表示セクション */}\r\n      <div style={{ textAlign: 'center', marginBottom: '2rem' }}>\r\n        {loading ? (\r\n          <p>経路データを読み込み中...</p>\r\n        ) : error ? (\r\n          <p style={{ color: 'red' }}>エラー: {error}</p>\r\n        ) : (\r\n          <>\r\n            {/* 現在のノード情報の表示 */}\r\n            <p style={{ fontSize: '1.2rem', fontWeight: 'bold', color: '#333' }}>\r\n              現在のノード: <span style={{ color: '#0066cc' }}>{confirmedMapNode}</span>\r\n            </p>\r\n            <p style={{ fontSize: '1.2rem', fontWeight: 'bold', color: '#333' }}>\r\n              現在の階: <span style={{ color: '#0066cc' }}>{currentFloor || 'N/A'}</span>\r\n            </p>\r\n            <p style={{ fontSize: '1.2rem', fontWeight: 'bold', color: '#333' }}>\r\n              現在の館: <span style={{ color: '#0066cc' }}>{currentBuilding || 'N/A'}</span>\r\n            </p>\r\n            <p style={{ fontSize: '1.2rem', fontWeight: 'bold', color: '#333' }}>\r\n              目的地ノード: <span style={{ color: '#28a745' }}>{goalNode || '未設定'}</span>\r\n            </p>\r\n            {/* 案内メッセージの表示 */}\r\n            <p style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#000' }}>\r\n              案内: <span style={{ color: '#d9534f' }}>{guidanceMessage}</span>\r\n            </p>\r\n            {/* 次のポイントの表示 */}\r\n            <p style={{ fontSize: '1.2rem', fontWeight: 'bold', color: '#333' }}>\r\n              次のポイント: <span style={{ color: '#5cb85c' }}>{nextPoint !== null ? nextPoint : '到着'}</span>\r\n            </p>\r\n\r\n            {/* 「次のポイントへ進む」デモ用ボタン */}\r\n            {nextPoint !== null && ( // 次のポイントが存在する場合のみボタンを表示\r\n              <button\r\n                onClick={handleMoveToNextPoint}\r\n                style={{\r\n                  padding: '10px 20px',\r\n                  fontSize: '1.2rem',\r\n                  marginTop: '15px',\r\n                  cursor: 'pointer',\r\n                  backgroundColor: '#007bff',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '5px'\r\n                }}\r\n              >\r\n                次のポイントへ進む (デモ用)\r\n              </button>\r\n            )}\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* 現在地入力フォームセクション */}\r\n      <div style={{ padding: '2rem', textAlign: 'center' }}>\r\n        <h2>現在の場所の番号を入力し、確定ボタンを押してください。</h2>\r\n      </div>\r\n\r\n      <div style={{ textAlign: 'center', marginBottom: '1rem' }}>\r\n        <input\r\n          type=\"text\"\r\n          pattern=\"\\d{1,2}\"\r\n          inputMode=\"numeric\"\r\n          value={arrivedNumber}\r\n          onChange={handleInputChange} // 入力値の変更をハンドル\r\n          placeholder=\"例: 1 (1〜32)\"\r\n          maxLength=\"2\"\r\n          style={{\r\n            padding: '0.8rem',\r\n            fontSize: '1.2rem',\r\n            width: '250px',\r\n            textAlign: 'center',\r\n            borderRadius: '5px',\r\n            border: inputError ? '2px solid red' : '1px solid #ccc',\r\n            marginBottom: '10px', // ボタンとの間の余白\r\n          }}\r\n        />\r\n        {/* 入力エラーメッセージの表示 */}\r\n        {inputError && (\r\n          <p style={{ color: 'red', fontSize: '0.9rem', marginTop: '0.5rem' }}>\r\n            {inputError}\r\n          </p>\r\n        )}\r\n        \r\n        {/* 「確定」ボタン */}\r\n        <button\r\n          onClick={handleConfirmCurrentNode} // クリック時に現在地を確定\r\n          style={{\r\n            padding: '10px 20px',\r\n            fontSize: '1.2rem',\r\n            cursor: 'pointer',\r\n            backgroundColor: '#28a745', // 緑色のボタン\r\n            color: 'white',\r\n            border: 'none',\r\n            borderRadius: '5px',\r\n            display: 'block', // ブロック要素にして中央揃えを容易に\r\n            margin: '0.5rem auto 0 auto', // 上に余白、左右中央揃え\r\n          }}\r\n        >\r\n          確定\r\n        </button>\r\n      </div>\r\n\r\n      {/* 戻るボタン */}\r\n      <div style={{ textAlign: 'center', marginBottom: '2rem' }}>\r\n        <Link to=\"/choose\">\r\n          <img src={backbutton} alt=\"戻る\" style={{ width: '200px', height: 'auto' }} />\r\n        </Link>\r\n      </div>\r\n\r\n      {/* フッターセクション */}\r\n      <footer style={{ backgroundColor: '#ddd', textAlign: 'center', padding: '1rem' }}>\r\n        <p>&copy; 2025 ナビゲスト</p>\r\n      </footer>\r\n    </>\r\n  );\r\n};\r\n\r\n// コンポーネント名を MapPage に変更してエクスポート\r\nexport default MapPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}